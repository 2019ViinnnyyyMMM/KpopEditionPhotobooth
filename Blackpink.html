<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Customizable Photobooth Frame</title>
<script src="auth.js"></script>
    <style>
        body {font-family:Inter, system-ui, Arial; text-align: center; display: flex; flex-direction: column; align-items: center; margin: 16px; background: url(dahlah.png);}
        h1{margin: 6px 0 12px; font-size:30px; }
        .top-row{display: flex; justify-content: center; gap: 20px; align-items: flex-start; flex-wrap: wrap;}
        .camera-wrap{position: relative; width: 640px; max-width: 100%;}
        video#video{display: block; width: 640px; height: 480px; border: 3px solid #222; border-radius:4px; margin-bottom: 0 auto;transform: scaleX(-1);
                   filter: grayscale(100%) sepia(100%) brightness(1.2);}
        #countdown{position: absolute; top: 50%; left: 50%; transform: translate(-50%, -50%); color: white; font-weight: bold; z-index: 20;}
        canvas#overlay{position: absolute; left: 0; width: 640px; height: 480px; background: transparent; margin-bottom: 10px;}
        #frame {
            display: flex;
            flex-direction: column;
            gap: 14px;
            margin-top: 10px auto;
            align-items: center;
        }
        .photo-slot {
            width: 640px;
            height: 480px;
            max-width: 95%;
            background: #f4f4f4;
            border: 10px solid #000;
            box-sizing: border-box;
            position: relative;
            overflow: hidden;
            display: flex;
            align-items: center;
            justify-content: center;
        }
        .sticker {
            position: absolute;
            top: 0;
            right: 0;
            height: 100%;
            z-index: 10;
            cursor: move;
        }
        #stickerMenu {border: 1px solid black; display: none; padding: 10px; margin-top: 10px; background: #fff;}
        #stickerMenu img {width: 80px; margin: 5px; cursor: pointer;}
        #wrapper {position: relative; display: inline-block;}
        .stickerOption {width: 80px; cursor: pointer; border: 1px solid transparent;}
        .stickerOption:hover {border: 1px solid black;}
        .title{text-align: center; margin: 20px 0; font-family: Inter, system-ui, Arial; color: white;}
        .title .main{display: block; font-size: 36px; font-weight: bolder; letter-spacing: 1px; color: white;}
        .title .sub{display: block; font-size: 18px; font-weight: 800; color:white; margin-top: 5px;}
        .photostrip{width: 640px; margin: 20px auto; border: 8px solid black; padding: 10px; text-align: center; background-color: #000;}
        .photostrip .logo{margin-bottom: 10px; border: 2px solid black;}
        .custom-button{background-color: black; color: white; padding: 8px 18px; border: none; border-radius: 30px; font-size: 14px; font-weight: bold; margin: 10px;}
    </style>
</head>
<body>

<h2>Photobox - Kpop Edition</h2>

<div id="wrapper" style="position: relative;">
    <video id="video" autoplay playsinline muted></video>
    <canvas id="canvas" width="640" height="480" style="display: none;"></canvas>
    <div id="countdown" style="font-size: 4em; text-align: center; margin-top: 20px;"></div>
<div id="timer"></div>
<div id="stickerMenu" style="display: none;">
    <img src="image (2).png" class="stickerOption">
    <img src="image (4).png" class="stickerOption">
    <img src="jhgfddd.png" class="stickerOption">
    <img src ="image (3).png" class="stickerOption">
</div>
</div>

<br>
<button id="addStickerBtn" class="custom-button">Add Kpop Idol Sticker</button>
<div class="custom-button" id="addFilterBtn">Choose Your Filter</div>
<div class="filter-options">
    <button onclick="applyFilter('none')">None</button>
    <button onclick="applyFilter('grayscale')">Grayscale</button>
    <button onclick="applyFilter('sepia')">Sepia</button>
    <button onclick="applyFilter('brightness')">Brightness</button>
</div>
<button id="startBtn" class="custom-button">Take Photo</button>
<br><br>

<div id="photostripContainer" class="photostrip">
    <img id="logo" src="blaccckkkpinkeu-removebg-preview.png" alt="logo" style="max-width:500px">

    <div id="frame">
        <img id="photo1" class="photo-slot">
        <img id="photo2" class="photo-slot">
        <img id="photo3" class="photo-slot">
        <img id="photo4" class="photo-slot">
    </div>
    <h3 class="title">
        <span class="main">PHOTOBOX</span>
        <span class="sub">KPOP EDITION</span>
    </h3>
</div>
<button id="downloadBtn" class="custom-button">Download Photostrip</button>
</body>
</html>

<script src="https://cdn.jsdelivr.net/npm/html2canvas@1.4.1/dist/html2canvas.min.js"></script>
<script>
const video = document.getElementById('video');
const canvas = document.getElementById('canvas');
const context = canvas.getContext('2d');
const addStickerBtn = document.getElementById('addStickerBtn');
const addFilterBtn = document.getElementById('addFilterBtn');
const container = document.getElementById('photostripContainer');

navigator.mediaDevices.getUserMedia({ video: true })
    .then(stream => {
        document.getElementById('video').srcObject = stream;
    })
    .catch(err => {
        console.error("Camera error:", err);
    });

addStickerBtn.addEventListener('click', () => {
    const stickerMenu = document.getElementById('stickerMenu');
    if (stickerMenu.style.display === 'none' || stickerMenu.style.display === '') { 
        stickerMenu.style.display = 'block';
    } else {
        stickerMenu.style.display = 'none';
    }
});

let selectedSticker = null;

document.querySelectorAll('.stickerOption').forEach((img, index) => {
    img.addEventListener('click', () => {
        selectedSticker = img.src;

        document.querySelectorAll('.sticker').forEach(s => s.remove());

        const wrapper = document.getElementById('wrapper');
        const sticker = document.createElement('img');
        sticker.src = selectedSticker;
        sticker.className = 'sticker';
        sticker.style.position = 'absolute';
        sticker.style.right = '0px';
        sticker.style.top = '0px';
        sticker.style.height = video.offsetHeight + 'px';
        sticker.style.zIndex = 10;

        sticker.style.filter = video.style.filter;

        wrapper.appendChild(sticker);

        sticker.onload = () => {
            console.log("Selected sticker:", sticker.src,
                        "Width:", sticker.naturalWidth,
                        "Height:", sticker.naturalHeight);
            const aspectRatio = sticker.naturalWidth / sticker.naturalHeight;
            sticker.style.height = video.offsetHeight + 'px';
            sticker.style.width = (video.offsetHeight * aspectRatio) + 'px';
        };

        document.getElementById('stickerMenu').style.display = 'none';
    });
});
                                                    
function applyFilter(filterClass) {
    video.className = '';
    if (filterClass === 'grayscale') video.style.filter = 'grayscale(100%)';
    else if (filterClass === 'sepia') video.style.filter = 'sepia(100%)';
    else if (filterClass === 'brightness') video.style.filter = 'brightness(1.5)';
    else video.style.filter = 'none';
}

document.getElementById('startBtn').addEventListener('click', startCountdown);

function startCountdown() {
    const countdownEl = document.getElementById("countdown");
    let count = 3;

    countdownEl.textContent = count;

    const interval = setInterval(() => {
        count--;
        if (count > 0) {
            countdownEl.textContent = count;
        } else {
            clearInterval(interval);
            countdownEl.textContent = "Smile!";

            setTimeout(() => {
                countdownEl.textContent = "";
                capturePhoto();
            }, 1000);
        }
    }, 1000);
}
    
let photoSlot = 1;
function capturePhoto() {
    const video = document.getElementById('video');
    const canvas = document.getElementById('canvas');
    const ctx = canvas.getContext('2d');

    canvas.width = video.videoWidth;
    canvas.height = video.videoHeight;

    ctx.translate(canvas.width, 0);
    ctx.scale(-1, 1);
    
    ctx.drawImage(video, 0, 0, canvas.width, canvas.height);
    
    if (selectedSticker) {
        const img = new Image();
        img.src = selectedSticker;

        img.onload = () => {
            const stickerHeight = canvas.height;
            const stickerWidth = (img.width / img.height) * stickerHeight;

            ctx.drawImage(
                img,
                0,
                0,
                stickerWidth,
                stickerHeight
            );
            
            const photoId = `photo${photoSlot}`;
            const photoElement = document.getElementById(photoId);
            photoElement.src = canvas.toDataURL("image/png");

            if (photoSlot < 4) {
                photoSlot++;
            } else {
                photoSlot = 1;
            }
        };
    }
};
document.getElementById("downloadBtn").addEventListener("click", function() {
    const container = document.getElementById("photostripContainer");

    if (!container) {
        console.error("X photostripContainer not found!");
        return;
    }

    html2canvas(container, {backgroundColor: null}).then(canvas => {
        let link = document.createElement("a");
        link.download = "photostrip.png";
        link.href = canvas.toDataURL("image/png");
        link.click();
        
        setTimeout(() => {
            window.location.href = "thanku.html";
        }, 1000);
    });
</script>
</body>
</html>


























